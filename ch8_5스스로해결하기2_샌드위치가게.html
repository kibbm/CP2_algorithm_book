<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>샌드위치 가게 시뮬레이터</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 900px;
            margin: auto;
            padding: 2rem;
        }
        .node {
            width: 50px;
            height: 50px;
            border-radius: 9999px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease-in-out;
            cursor: pointer;
        }
        .node-default {
            background-color: #e5e7eb;
            color: #4b5563;
            border: 2px solid #d1d5db;
        }
        .node-start {
            background-color: #3b82f6;
            color: #ffffff;
            border: 2px solid #2563eb;
            transform: scale(1.1);
            box-shadow: 0 4px 6px rgba(59, 130, 246, 0.4);
        }
        .edge {
            stroke: #4b5563;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead);
        }
        #result-text {
            white-space: pre-wrap;
        }
        .step-info {
            background-color: #f9fafb;
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            min-height: 120px;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

<div class="container bg-white rounded-xl shadow-lg p-8">
    <h1 class="text-3xl font-bold text-gray-800 text-center mb-6">샌드위치 가게 시뮬레이터</h1>
    <p class="text-center text-gray-600 mb-8">
        '지금 당장 시작할 수 있는 일(진입차수 0)'을 찾아보세요.
    </p>

    <div class="grid md:grid-cols-2 gap-8 mb-8">
        <div>
            <div class="mb-4">
                <label for="N-input" class="block text-gray-700 font-medium mb-2">N (노드의 개수)</label>
                <input type="number" id="N-input" value="5" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div class="mb-4">
                <label for="edges-input" class="block text-gray-700 font-medium mb-2">
                    간선 (edges)
                    <span class="text-sm text-gray-500 block">형식: (1,3), (2,3), (3,4), (4,5)</span>
                </label>
                <input type="text" id="edges-input" value="(1,3), (2,3), (3,4), (4,5)" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div class="flex space-x-4 mb-6">
                <button onclick="runSimulation()" class="flex-1 bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300 ease-in-out shadow-md">시뮬레이션 시작</button>
                <button onclick="resetSimulation()" class="bg-gray-400 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-500 transition duration-300 ease-in-out shadow-md">초기화</button>
            </div>
        </div>
        
        <div>
            <div class="step-info">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">단계 정보</h3>
                <p id="step-description" class="text-gray-700">시뮬레이션을 시작하려면 버튼을 클릭하세요.</p>
            </div>
            <div class="mt-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">최종 결과</h3>
                <p id="result-text" class="text-gray-700 font-mono bg-gray-50 p-4 rounded-lg border border-gray-200">아직 결과가 없습니다.</p>
            </div>
        </div>
    </div>

    <!-- Graph Visualization -->
    <div class="bg-gray-50 p-6 rounded-xl border border-gray-200 shadow-inner">
        <h2 class="text-2xl font-semibold text-center text-gray-800 mb-4">그래프 시각화</h2>
        <svg id="graph-svg" class="w-full h-[400px] bg-white rounded-lg border border-gray-200"></svg>
    </div>
</div>

<script>
    const NInput = document.getElementById('N-input');
    const edgesInput = document.getElementById('edges-input');
    const stepDescription = document.getElementById('step-description');
    const resultText = document.getElementById('result-text');
    const svg = document.getElementById('graph-svg');

    let N, edges;
    let indegree;
    let nodePositions = {};
    let nodeElements = {};

    function parseEdges(edgesStr) {
        if (!edgesStr) return [];
        const regex = /\((\d+),(\d+)\)/g;
        const result = [];
        let match;
        while ((match = regex.exec(edgesStr)) !== null) {
            result.push([parseInt(match[1]), parseInt(match[2])]);
        }
        return result;
    }

    function initializeGraph() {
        N = parseInt(NInput.value);
        edges = parseEdges(edgesInput.value);
        indegree = Array(N + 1).fill(0);

        edges.forEach(([u, v]) => {
            if (v > 0 && v <= N) {
                indegree[v]++;
            }
        });
    }

    function createGraphElements() {
        svg.innerHTML = `
            <defs>
                <marker id="arrowhead" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
                    <path d="M 0 0 L 10 5 L 0 10 z" fill="#4b5563" />
                </marker>
            </defs>
        `;

        const width = svg.clientWidth;
        const height = svg.clientHeight;
        const center = { x: width / 2, y: height / 2 };
        const radius = Math.min(width, height) / 2.5;

        nodePositions = {};
        nodeElements = {};

        // 노드 위치 계산
        for (let i = 1; i <= N; i++) {
            const angle = (2 * Math.PI / N) * (i - 1);
            nodePositions[i] = {
                x: center.x + radius * Math.cos(angle),
                y: center.y + radius * Math.sin(angle)
            };
        }

        // 간선 그리기
        edges.forEach(([u, v]) => {
            const edgePath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            const start = nodePositions[u];
            const end = nodePositions[v];
            
            if (start && end) {
                const dx = end.x - start.x;
                const dy = end.y - start.y;
                const dist = Math.sqrt(dx * dx + dy * dy);
                const unitVx = dx / dist;
                const unitVy = dy / dist;

                const offset = 25; 
                const newStart = { x: start.x + unitVx * offset, y: start.y + unitVy * offset };
                const newEnd = { x: end.x - unitVx * offset, y: end.y - unitVy * offset };

                const pathData = `M ${newStart.x} ${newStart.y} L ${newEnd.x} ${newEnd.y}`;

                edgePath.setAttribute('d', pathData);
                edgePath.setAttribute('class', 'edge');
                svg.appendChild(edgePath);
            }
        });

        // 노드 그리기
        for (let i = 1; i <= N; i++) {
            const nodeG = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            const pos = nodePositions[i];
            if (pos) {
                nodeG.setAttribute('transform', `translate(${pos.x}, ${pos.y})`);
                nodeG.setAttribute('class', 'node node-default');

                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('r', 25);
                circle.setAttribute('fill', '#e5e7eb');
                circle.setAttribute('stroke', '#d1d5db');
                circle.setAttribute('stroke-width', '2');
                nodeG.appendChild(circle);

                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('alignment-baseline', 'middle');
                text.setAttribute('font-size', '1.5rem');
                text.setAttribute('font-weight', '600');
                text.setAttribute('fill', '#4b5563');
                text.textContent = i;
                nodeG.appendChild(text);

                svg.appendChild(nodeG);
                nodeElements[i] = nodeG;
            }
        }
    }

    function runSimulation() {
        try {
            resetSimulation();
            initializeGraph();
            createGraphElements();

            stepDescription.textContent = '진입 차수를 계산하고, 진입 차수가 0인 노드를 찾습니다.';
            
            const startNodes = [];
            for (let i = 1; i <= N; i++) {
                if (indegree[i] === 0) {
                    startNodes.push(i);
                    if (nodeElements[i]) {
                        nodeElements[i].setAttribute('class', 'node node-start');
                        nodeElements[i].querySelector('circle').style.fill = '#3b82f6';
                        nodeElements[i].querySelector('circle').style.stroke = '#2563eb';
                        nodeElements[i].querySelector('text').style.fill = '#ffffff';
                    }
                }
                const pos = nodePositions[i];
                if (pos) {
                    const textEl = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    textEl.setAttribute('x', pos.x + 30);
                    textEl.setAttribute('y', pos.y);
                    textEl.setAttribute('class', 'indegree-text text-sm fill-gray-600');
                    textEl.textContent = `indeg: ${indegree[i]}`;
                    svg.appendChild(textEl);
                }
            }
            
            resultText.textContent = `진입차수: [0, ${indegree.slice(1).join(', ')}]\n시작 가능: [${startNodes.join(', ')}]`;

        } catch (e) {
            console.error("An error occurred during simulation:", e);
            stepDescription.textContent = `오류 발생: ${e.message}. 콘솔을 확인해주세요.`;
            resultText.textContent = `시뮬레이션 중 오류가 발생했습니다.`;
        }
    }

    function resetSimulation() {
        svg.innerHTML = '';
        stepDescription.textContent = '시뮬레이션을 시작하려면 버튼을 클릭하세요.';
        resultText.textContent = '아직 결과가 없습니다.';
        nodePositions = {};
        nodeElements = {};
    }

    // 초기 상태 설정
    window.onload = resetSimulation;

</script>

</body>
</html>
<!--요청하신 '샌드위치 가게 시뮬레이터'는 단계별 진행을 지원하지 않습니다. 이 시뮬레이터는 **'지금 바로 시작할 수 있는 일'**이라는 문제의 핵심에 맞춰, 최종 결과만 즉시 계산하여 보여주도록 설계되었습니다.

따라서 '다음' 버튼은 따로 없으며, '시뮬레이션 시작' 버튼을 누르는 순간 진입 차수 계산이 완료되고 최종 결과가 화면에 나타납니다.-->